import os
import datetime
import pytz
import asyncio
from telegram import Bot

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ—Ä—É—Ç—Å—è –∏–∑ —Å–µ–∫—Ä–µ—Ç–æ–≤ GitHub (–∏–ª–∏ .env –ª–æ–∫–∞–ª—å–Ω–æ)
TOKEN = os.getenv("TELEGRAM_BOT_TOKEN")
CHAT_ID = os.getenv("TELEGRAM_CHAT_ID")
TIMEZONE_STR = os.getenv("TIMEZONE", "Europe/Moscow")

# –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
# 0: –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, 1: –í—Ç–æ—Ä–Ω–∏–∫, ..., 6: –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ
SCHEDULE = {
    0: "üìÖ –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫:\n1. –£—Ç—Ä–µ–Ω–Ω—è—è —Ä–∞–∑–º–∏–Ω–∫–∞\n2. –†–∞–±–æ—Ç–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏\n3. –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫",
    1: "üìÖ –í—Ç–æ—Ä–Ω–∏–∫:\n1. –ü–ª–∞–Ω–µ—Ä–∫–∞\n2. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ\n3. –ß—Ç–µ–Ω–∏–µ –∫–Ω–∏–≥–∏",
    2: "üìÖ –°—Ä–µ–¥–∞:\n1. –í–µ–±–∏–Ω–∞—Ä\n2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ—Ç—á–µ—Ç–∞\n3. –ü—Ä–æ–≥—É–ª–∫–∞",
    3: "üìÖ –ß–µ—Ç–≤–µ—Ä–≥:\n1. –ù–∞–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞\n2. –†–µ–≤—å—é –ø—Ä–æ–µ–∫—Ç–∞\n3. –ü–æ—Ö–æ–¥ –≤ —Å–ø–æ—Ä—Ç–∑–∞–ª",
    4: "üìÖ –ü—è—Ç–Ω–∏—Ü–∞:\n1. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∑–∞ –Ω–µ–¥–µ–ª—é\n2. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–¥–∞—á\n3. –ö–∏–Ω–æ–≤–µ—á–µ—Ä",
    5: "üìÖ –°—É–±–±–æ—Ç–∞:\n1. –û—Ç–¥—ã—Ö –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ\n2. –£–±–æ—Ä–∫–∞\n3. –•–æ–±–±–∏",
    6: "üìÖ –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ:\n1. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–∏\n2. –ú–µ–¥–∏—Ç–∞—Ü–∏—è\n3. –°–µ–º–µ–π–Ω—ã–π —É–∂–∏–Ω"
}

async def main():
    if not TOKEN or not CHAT_ID:
        print("–û—à–∏–±–∫–∞: –¢–æ–∫–µ–Ω –∏–ª–∏ ID —á–∞—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!")
        return

    bot = Bot(token=TOKEN)
    tz = pytz.timezone(TIMEZONE_STR)
    now = datetime.datetime.now(tz)
    
    weekday = now.weekday()
    message = SCHEDULE.get(weekday, "–ù–∞ —Å–µ–≥–æ–¥–Ω—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–µ –∑–∞–¥–∞–Ω–æ!")
    
    print(f"–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –¥–Ω—è {weekday}...")
    try:
        await bot.send_message(chat_id=CHAT_ID, text=message)
        print("–£—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!")
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ: {e}")

if __name__ == "__main__":
    asyncio.run(main())
